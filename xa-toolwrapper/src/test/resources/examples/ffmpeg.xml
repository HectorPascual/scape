<?xml version="1.0" encoding="UTF-8"?>
<toolspec model="0.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:noNamespaceSchemaLocation="../../../../src/main/resources/toolspec-temp.xsd">
    <id>ffmpeg</id>
    <name>ffmpeg</name>
    <homepage>http://ffmpeg.org/</homepage>
    <version>SVN-r25305-snapshot</version><!--<version>0.9.1</version>-->
    <installation>
        <os type="linux">
            FFMPEG can be cloned from the Git repository.
        </os>
        <os type="windows">
            TODO
        </os>
    </installation>
    <services>
        <service sid="1" name="FFMPEG" type="migrate" servicepackage="eu.scape_project.pc.services" contextpathprefix="/scapeservices">
            <description>Service for migrating audio files</description>
            <operations>
                <operation oid="1" name="ffmpegMigrate">
                    <description>Migrates an mp3 file to the wav file format</description>
                    <command>ffmpegMigrateMp3ToWav.sh ${mp3} ${wav}</command>
                    <inputs>
                        <input name="mp3">
                            <Datatype>xsd:anyURI</Datatype>
                            <Required>true</Required>
                            <CliMapping>mp3</CliMapping>
                            <Documentation>URL reference to input file</Documentation>
                            <Default>http://iapetus:9441/scape-data/test-data/sample1.mp3</Default>
                        </input>
                    </inputs>
                    <outputs>
                        <output name="wav">
                            <Datatype>xsd:anyURI</Datatype>
                            <CliMapping>wav</CliMapping>
                            <Required>true</Required>
                            <Documentation>URL reference to Wave output file</Documentation>
                            <PrefixFromInput>mp3</PrefixFromInput>
                            <Extension>wav</Extension>
                        </output>
                    </outputs>
                </operation>
                <operation oid="2" name="ffmpegCut">
                    <description>Cut out a piece of an audio file</description>
                    <command>ffmpegCut.sh ${input_file} ${timestampStart} ${durationTimestamp} ${extension} ${output_file}</command>
                    <inputs>
                        <input name="input_file">
                            <Datatype>xsd:anyURI</Datatype>
                            <Required>true</Required>
                            <CliMapping>input_file</CliMapping>
                            <Documentation>URL reference to input file</Documentation>
                            <Default>http://iapetus:9441/scape-data/test-data/sample1.wav</Default>
                        </input>
                        <input name="timestampStart">
                            <Datatype>xsd:string</Datatype>
                            <Required>true</Required>
                            <CliMapping>timestampStart</CliMapping>
                            <Documentation>timeStamp indicating where in input file to start cut. position may be either in seconds or in hh:mm:ss[.xxx] form.</Documentation>
                            <Default>0</Default>
                        </input>
                        <input name="durationTimestamp">
                            <Datatype>xsd:string</Datatype>
                            <Required>true</Required>
                            <CliMapping>durationTimestamp</CliMapping>
                            <Documentation>Stop writing the output after its duration reaches durationTimestamp. duration may be a number in seconds, or in hh:mm:ss[.xxx] form. </Documentation>
                            <Default>20</Default>
                        </input>
                        <input name="extension">
                            <Datatype>xsd:string</Datatype>
                            <Required>true</Required>
                            <CliMapping>extension</CliMapping>
                            <Documentation>The extension and thus the format of the output file</Documentation>
                            <Default>wav</Default>
                        </input>
                    </inputs>
                    <outputs>
                        <output name="output_file">
                            <Datatype>xsd:anyURI</Datatype>
                            <CliMapping>output_file</CliMapping>
                            <Required>true</Required>
                            <Documentation>URL reference to cut output file</Documentation>
                            <PrefixFromInput>input_file</PrefixFromInput>
                            <Extension>tmp</Extension>
                        </output>
                    </outputs>
                </operation>
            </operations>
            <deployto>
                <deployref default="true" ref="iapetus"/>
            </deployto>
        </service>
    </services>
    <deployments>
        <deployment id="local">
            <identifier>http://localhost:8080/scape/instances/tomcat1</identifier>
            <host>localhost</host>
            <ports>
                <port type="http">8080</port>
                <port type="https">8043</port>
            </ports>
            <manager>
                <user>tomcat</user>
                <password>password</password>
                <path>manager</path>
            </manager>
            <toolsbasedir></toolsbasedir>
            <dataexchange>
                <accessdir>webapps/ROOT/scape/tmp/</accessdir>
                <accessurl>http://localhost:8080/scape/tmp/</accessurl>
            </dataexchange>
        </deployment>
        <deployment id="iapetus">
            <identifier>http://iapetus:9441/</identifier>
            <host>iapetus</host>
            <ports>
                <port type="http">9441</port>
            </ports>
            <manager>
                <user>tomcat</user>
                <password>password</password>
                <path>manager</path>
            </manager>
            <toolsbasedir>/home/scape/tools/ffmpeg/</toolsbasedir>
            <dataexchange>
                <accessdir>services/webapps/scape-data/ffmpeg-output/</accessdir>
                <accessurl>http://iapetus:9441/scape-data/ffmpeg-output/</accessurl>
            </dataexchange>
        </deployment>
    </deployments>
</toolspec>
